#nsis_decrypt.py - a simple decrypter for some second stage payloads.

In some cases after unpacking a nullsoft installer sample with 7z you may see the following files.
1) System.dll - used by Nullsoft Installer to invoke dll functions from other DLL
2) Randomly named DLL - I have seen cdrom.dll, Registry.dll, Blowfish.dll, SetCursor.dll and others.
3) Two randomly named data files, one of just a few kilobytes and a larger one of more than 100 kilobytes.

In this case the larger of the two data files may contain an encyphered payload, encoded using a double XOR based 
on a key hard coded into the Randomly named DLL.  

##Obtaining the Key

1) Load the file into IDA, a Hex Editor, or simply run it through strings.  
2) Search for the names of the two data files in plain text.  In some samples you will see slightly
   altered versions of the filenames.  In this case this tool will not decrypt the payload.
3) Directly above the filenames should be another fairly random looking string eg. "MesteeNeutralise".
   This will be the key.
   
##Usage

Usage: nsis_decrypt.py [options]

Options:
  -h, --help            show this help message and exit
  -f FILE, --file=FILE  File to decrypt
  -k KEY, --key=KEY     Cypher key
  -o FILE, --out=FILE   Output file

Note that the -f and -k options are obligatory.
